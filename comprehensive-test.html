<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Testing Suite - Agentic Docs POC</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: #0f1419;
            color: #ffffff;
        }
        
        h1 {
            color: #d71921;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #8b949e;
            margin-bottom: 30px;
        }
        
        .test-section {
            background: #1a1f26;
            border: 1px solid #2d3440;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .test-section h2 {
            margin-top: 0;
            color: #58a6ff;
        }
        
        .test-result {
            padding: 12px;
            margin: 10px 0;
            border-radius: 4px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        
        .test-result-icon {
            font-size: 20px;
            flex-shrink: 0;
        }
        
        .test-result-content {
            flex: 1;
        }
        
        .test-result-title {
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .test-result-message {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .pass {
            background: #10b98144;
            border-left: 4px solid #10b981;
        }
        
        .fail {
            background: #ef444444;
            border-left: 4px solid #ef4444;
        }
        
        .warn {
            background: #f59e0b44;
            border-left: 4px solid #f59e0b;
        }
        
        .info {
            background: #3b82f644;
            border-left: 4px solid #3b82f6;
        }
        
        button {
            background: #d71921;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px 10px 0;
            transition: background 0.2s;
        }
        
        button:hover {
            background: #b01419;
        }
        
        button:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        #results {
            margin-top: 20px;
        }
        
        .summary {
            font-size: 24px;
            font-weight: bold;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            background: #1a1f26;
            border: 2px solid;
        }
        
        .summary.pass {
            color: #10b981;
            border-color: #10b981;
        }
        
        .summary.fail {
            color: #ef4444;
            border-color: #ef4444;
        }
        
        .summary.warn {
            color: #f59e0b;
            border-color: #f59e0b;
        }
        
        .stats {
            display: flex;
            gap: 20px;
            margin-top: 10px;
            font-size: 16px;
        }
        
        .stat {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        code {
            background: #252b33;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 13px;
        }
        
        .progress {
            width: 100%;
            height: 8px;
            background: #2d3440;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #d71921, #ff4444);
            transition: width 0.3s;
        }
        
        .test-category {
            margin-bottom: 30px;
        }
        
        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .category-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-pass {
            background: #10b981;
            color: white;
        }
        
        .badge-fail {
            background: #ef4444;
            color: white;
        }
        
        .badge-warn {
            background: #f59e0b;
            color: white;
        }
    </style>
</head>
<body>
    <h1>üî¨ Comprehensive Testing Suite</h1>
    <p class="subtitle">Complete validation of the Agentic Docs POC mock website</p>
    
    <div class="test-section">
        <h2>Test Controls</h2>
        <button onclick="runAllTests()" id="runBtn">‚ñ∂Ô∏è Run All Tests</button>
        <button onclick="clearResults()">üóëÔ∏è Clear Results</button>
        <button onclick="exportResults()">üì• Export Results</button>
        <div class="progress" id="progress" style="display: none;">
            <div class="progress-bar" id="progressBar"></div>
        </div>
    </div>
    
    <div id="results"></div>
    
    <script>
        const pages = [
            { url: 'index.html', name: 'Landing Page' },
            { url: 'attack-surface.html', name: 'Attack Surface Discovery' },
            { url: 'workbench.html', name: 'Workbench' },
            { url: 'endpoint-inventory.html', name: 'Endpoint Inventory' }
        ];
        
        const jsModules = [
            'assets/js/context-engine.js',
            'assets/js/help-panel.js',
            'assets/js/tooltip.js',
            'assets/js/user-selector.js',
            'assets/js/navigation.js',
            'assets/js/content-generator.js'
        ];
        
        const cssFiles = [
            'assets/css/common.css',
            'assets/css/components.css',
            'assets/css/pages.css'
        ];
        
        const dataFiles = [
            'assets/data/help-content.json',
            'assets/data/tooltip-content.json'
        ];
        
        let results = [];
        let totalTests = 0;
        let completedTests = 0;
        
        function addResult(category, test, status, message, details = null) {
            results.push({ category, test, status, message, details });
            completedTests++;
            updateProgress();
            displayResults();
        }
        
        function updateProgress() {
            const progress = document.getElementById('progress');
            const progressBar = document.getElementById('progressBar');
            if (totalTests > 0) {
                progress.style.display = 'block';
                const percent = (completedTests / totalTests) * 100;
                progressBar.style.width = percent + '%';
            }
        }
        
        function displayResults() {
            const resultsDiv = document.getElementById('results');
            const categories = {};
            
            // Group by category
            results.forEach(r => {
                if (!categories[r.category]) {
                    categories[r.category] = [];
                }
                categories[r.category].push(r);
            });
            
            // Count totals
            const total = results.length;
            const passed = results.filter(r => r.status === 'pass').length;
            const failed = results.filter(r => r.status === 'fail').length;
            const warnings = results.filter(r => r.status === 'warn').length;
            const info = results.filter(r => r.status === 'info').length;
            
            const overallStatus = failed > 0 ? 'fail' : (warnings > 0 ? 'warn' : 'pass');
            
            let html = `
                <div class="summary ${overallStatus}">
                    <div>Test Results: ${passed}/${total} Passed</div>
                    <div class="stats">
                        <div class="stat">‚úÖ ${passed} passed</div>
                        <div class="stat">‚ùå ${failed} failed</div>
                        <div class="stat">‚ö†Ô∏è ${warnings} warnings</div>
                        <div class="stat">‚ÑπÔ∏è ${info} info</div>
                    </div>
                </div>
            `;
            
            // Display by category
            for (const [category, tests] of Object.entries(categories)) {
                const catPassed = tests.filter(t => t.status === 'pass').length;
                const catFailed = tests.filter(t => t.status === 'fail').length;
                const catWarnings = tests.filter(t => t.status === 'warn').length;
                
                let badgeClass = 'badge-pass';
                let badgeText = `${catPassed}/${tests.length}`;
                if (catFailed > 0) {
                    badgeClass = 'badge-fail';
                } else if (catWarnings > 0) {
                    badgeClass = 'badge-warn';
                }
                
                html += `
                    <div class="test-section test-category">
                        <div class="category-header">
                            <h2>${category}</h2>
                            <span class="category-badge ${badgeClass}">${badgeText}</span>
                        </div>
                `;
                
                tests.forEach(t => {
                    const icon = t.status === 'pass' ? '‚úÖ' : 
                                t.status === 'fail' ? '‚ùå' : 
                                t.status === 'warn' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
                    
                    html += `
                        <div class="test-result ${t.status}">
                            <div class="test-result-icon">${icon}</div>
                            <div class="test-result-content">
                                <div class="test-result-title">${t.test}</div>
                                <div class="test-result-message">${t.message}</div>
                                ${t.details ? `<div class="test-result-message"><code>${t.details}</code></div>` : ''}
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            }
            
            resultsDiv.innerHTML = html;
        }
        
        function clearResults() {
            results = [];
            completedTests = 0;
            totalTests = 0;
            document.getElementById('results').innerHTML = '';
            document.getElementById('progress').style.display = 'none';
        }
        
        function exportResults() {
            const data = {
                timestamp: new Date().toISOString(),
                summary: {
                    total: results.length,
                    passed: results.filter(r => r.status === 'pass').length,
                    failed: results.filter(r => r.status === 'fail').length,
                    warnings: results.filter(r => r.status === 'warn').length
                },
                results: results
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `test-results-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        async function runAllTests() {
            clearResults();
            document.getElementById('runBtn').disabled = true;
            
            // Calculate total tests
            totalTests = pages.length + jsModules.length + cssFiles.length + dataFiles.length + 30; // Approximate
            
            await testPageExistence();
            await testJavaScriptModules();
            await testCSSFiles();
            await testDataFiles();
            await testBrowserFeatures();
            await testHTMLStructure();
            await testAccessibility();
            await testKeyboardNavigation();
            await testResponsiveDesign();
            await testPerformance();
            
            addResult('Summary', 'All Tests Complete', 'info', 
                `Testing completed at ${new Date().toLocaleTimeString()}. Review results above.`);
            
            document.getElementById('runBtn').disabled = false;
            document.getElementById('progress').style.display = 'none';
        }
        
        async function testPageExistence() {
            for (const page of pages) {
                try {
                    const response = await fetch(page.url, { method: 'HEAD' });
                    if (response.ok) {
                        addResult('Page Existence', page.name, 'pass', 
                            `Page accessible at ${page.url}`);
                    } else {
                        addResult('Page Existence', page.name, 'fail', 
                            `HTTP ${response.status}: ${response.statusText}`);
                    }
                } catch (error) {
                    addResult('Page Existence', page.name, 'fail', error.message);
                }
            }
        }
        
        async function testJavaScriptModules() {
            for (const js of jsModules) {
                try {
                    const response = await fetch(js);
                    if (response.ok) {
                        const content = await response.text();
                        const lines = content.split('\n').length;
                        addResult('JavaScript Modules', js.split('/').pop(), 'pass', 
                            `Module loaded successfully (${lines} lines)`);
                    } else {
                        addResult('JavaScript Modules', js.split('/').pop(), 'fail', 
                            `HTTP ${response.status}`);
                    }
                } catch (error) {
                    addResult('JavaScript Modules', js.split('/').pop(), 'fail', error.message);
                }
            }
        }
        
        async function testCSSFiles() {
            for (const css of cssFiles) {
                try {
                    const response = await fetch(css);
                    if (response.ok) {
                        const content = await response.text();
                        const rules = content.split('}').length - 1;
                        addResult('CSS Files', css.split('/').pop(), 'pass', 
                            `CSS loaded successfully (~${rules} rules)`);
                    } else {
                        addResult('CSS Files', css.split('/').pop(), 'fail', 
                            `HTTP ${response.status}`);
                    }
                } catch (error) {
                    addResult('CSS Files', css.split('/').pop(), 'fail', error.message);
                }
            }
        }
        
        async function testDataFiles() {
            for (const data of dataFiles) {
                try {
                    const response = await fetch(data);
                    if (response.ok) {
                        const json = await response.json();
                        const keys = Object.keys(json).length;
                        addResult('Data Files', data.split('/').pop(), 'pass', 
                            `Valid JSON with ${keys} top-level keys`);
                    } else {
                        addResult('Data Files', data.split('/').pop(), 'fail', 
                            `HTTP ${response.status}`);
                    }
                } catch (error) {
                    addResult('Data Files', data.split('/').pop(), 'fail', error.message);
                }
            }
        }
        
        async function testBrowserFeatures() {
            // localStorage
            try {
                localStorage.setItem('test', 'value');
                const value = localStorage.getItem('test');
                localStorage.removeItem('test');
                if (value === 'value') {
                    addResult('Browser Features', 'localStorage', 'pass', 
                        'localStorage read/write working correctly');
                } else {
                    addResult('Browser Features', 'localStorage', 'fail', 
                        'localStorage read/write mismatch');
                }
            } catch (error) {
                addResult('Browser Features', 'localStorage', 'warn', 
                    'localStorage not available: ' + error.message);
            }
            
            // sessionStorage
            try {
                sessionStorage.setItem('test', 'value');
                const value = sessionStorage.getItem('test');
                sessionStorage.removeItem('test');
                if (value === 'value') {
                    addResult('Browser Features', 'sessionStorage', 'pass', 
                        'sessionStorage read/write working correctly');
                } else {
                    addResult('Browser Features', 'sessionStorage', 'fail', 
                        'sessionStorage read/write mismatch');
                }
            } catch (error) {
                addResult('Browser Features', 'sessionStorage', 'warn', 
                    'sessionStorage not available: ' + error.message);
            }
            
            // Fetch API
            if (typeof fetch === 'function') {
                addResult('Browser Features', 'Fetch API', 'pass', 
                    'Fetch API available');
            } else {
                addResult('Browser Features', 'Fetch API', 'fail', 
                    'Fetch API not available');
            }
            
            // ES6 Features
            try {
                eval('const test = () => {};');
                addResult('Browser Features', 'ES6 Support', 'pass', 
                    'ES6 arrow functions supported');
            } catch (error) {
                addResult('Browser Features', 'ES6 Support', 'fail', 
                    'ES6 features not supported');
            }
        }
        
        async function testHTMLStructure() {
            // Check required elements
            const requiredElements = ['head', 'body', 'title'];
            requiredElements.forEach(tag => {
                const element = document.querySelector(tag);
                if (element) {
                    addResult('HTML Structure', `<${tag}> element`, 'pass', 
                        `Element exists`);
                } else {
                    addResult('HTML Structure', `<${tag}> element`, 'fail', 
                        `Element missing`);
                }
            });
            
            // Check meta tags
            const charset = document.querySelector('meta[charset]');
            if (charset && charset.getAttribute('charset').toLowerCase() === 'utf-8') {
                addResult('HTML Structure', 'charset', 'pass', 
                    'UTF-8 charset declared');
            } else {
                addResult('HTML Structure', 'charset', 'warn', 
                    'UTF-8 charset not properly declared');
            }
            
            const viewport = document.querySelector('meta[name="viewport"]');
            if (viewport) {
                addResult('HTML Structure', 'viewport', 'pass', 
                    'Viewport meta tag present');
            } else {
                addResult('HTML Structure', 'viewport', 'warn', 
                    'Viewport meta tag missing');
            }
            
            // Check lang attribute
            const htmlLang = document.documentElement.getAttribute('lang');
            if (htmlLang) {
                addResult('HTML Structure', 'lang attribute', 'pass', 
                    `Language set to "${htmlLang}"`);
            } else {
                addResult('HTML Structure', 'lang attribute', 'fail', 
                    'Missing lang attribute on <html>');
            }
        }
        
        async function testAccessibility() {
            // Images
            const images = document.querySelectorAll('img');
            let imagesWithoutAlt = 0;
            images.forEach(img => {
                if (!img.hasAttribute('alt')) {
                    imagesWithoutAlt++;
                }
            });
            if (images.length === 0) {
                addResult('Accessibility', 'Image alt text', 'pass', 
                    'No images on this page');
            } else if (imagesWithoutAlt === 0) {
                addResult('Accessibility', 'Image alt text', 'pass', 
                    `All ${images.length} images have alt text`);
            } else {
                addResult('Accessibility', 'Image alt text', 'fail', 
                    `${imagesWithoutAlt} of ${images.length} images missing alt text`);
            }
            
            // Headings
            const h1Count = document.querySelectorAll('h1').length;
            if (h1Count === 1) {
                addResult('Accessibility', 'Heading structure', 'pass', 
                    'One h1 heading found');
            } else if (h1Count === 0) {
                addResult('Accessibility', 'Heading structure', 'warn', 
                    'No h1 heading found');
            } else {
                addResult('Accessibility', 'Heading structure', 'warn', 
                    `Multiple h1 headings found (${h1Count})`);
            }
            
            // Buttons
            const buttons = document.querySelectorAll('button');
            let buttonsWithoutText = 0;
            buttons.forEach(btn => {
                const hasText = btn.textContent.trim().length > 0;
                const hasAriaLabel = btn.hasAttribute('aria-label');
                if (!hasText && !hasAriaLabel) {
                    buttonsWithoutText++;
                }
            });
            if (buttons.length > 0) {
                if (buttonsWithoutText === 0) {
                    addResult('Accessibility', 'Button labels', 'pass', 
                        `All ${buttons.length} buttons have accessible names`);
                } else {
                    addResult('Accessibility', 'Button labels', 'fail', 
                        `${buttonsWithoutText} of ${buttons.length} buttons lack accessible names`);
                }
            }
            
            // Links
            const links = document.querySelectorAll('a');
            let linksWithoutText = 0;
            links.forEach(link => {
                const hasText = link.textContent.trim().length > 0;
                const hasAriaLabel = link.hasAttribute('aria-label');
                if (!hasText && !hasAriaLabel) {
                    linksWithoutText++;
                }
            });
            if (links.length > 0) {
                if (linksWithoutText === 0) {
                    addResult('Accessibility', 'Link labels', 'pass', 
                        `All ${links.length} links have accessible names`);
                } else {
                    addResult('Accessibility', 'Link labels', 'fail', 
                        `${linksWithoutText} of ${links.length} links lack accessible names`);
                }
            }
            
            // Color contrast
            addResult('Accessibility', 'Color contrast', 'info', 
                'Use a contrast checker tool (e.g., WAVE, axe DevTools) for accurate WCAG compliance testing');
        }
        
        async function testKeyboardNavigation() {
            const focusableElements = document.querySelectorAll(
                'a, button, input, select, textarea, [tabindex]:not([tabindex="-1"])'
            );
            
            if (focusableElements.length > 0) {
                addResult('Keyboard Navigation', 'Focusable elements', 'pass', 
                    `${focusableElements.length} focusable elements found`);
            } else {
                addResult('Keyboard Navigation', 'Focusable elements', 'warn', 
                    'No focusable elements found on this page');
            }
            
            // Check for positive tabindex (anti-pattern)
            const positiveTabindex = document.querySelectorAll(
                '[tabindex]:not([tabindex="0"]):not([tabindex="-1"])'
            );
            if (positiveTabindex.length === 0) {
                addResult('Keyboard Navigation', 'Tab order', 'pass', 
                    'No positive tabindex values (good practice)');
            } else {
                addResult('Keyboard Navigation', 'Tab order', 'warn', 
                    `${positiveTabindex.length} elements with positive tabindex may disrupt tab order`);
            }
            
            addResult('Keyboard Navigation', 'Manual testing required', 'info', 
                'Test Tab, Enter, ESC keys manually to verify keyboard navigation');
        }
        
        async function testResponsiveDesign() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            
            addResult('Responsive Design', 'Current viewport', 'info', 
                `${width}x${height} pixels`);
            
            if (width >= 1920) {
                addResult('Responsive Design', 'Desktop (1920+)', 'pass', 
                    'Testing on desktop resolution');
            } else if (width >= 1366) {
                addResult('Responsive Design', 'Laptop (1366+)', 'pass', 
                    'Testing on laptop resolution');
            } else if (width >= 768) {
                addResult('Responsive Design', 'Tablet (768+)', 'warn', 
                    'Testing on tablet resolution - verify layout');
            } else {
                addResult('Responsive Design', 'Mobile (<768)', 'warn', 
                    'Testing on mobile resolution - verify layout');
            }
            
            addResult('Responsive Design', 'Manual testing', 'info', 
                'Test on multiple screen sizes and devices for complete validation');
        }
        
        async function testPerformance() {
            if (performance && performance.timing) {
                const timing = performance.timing;
                const loadTime = timing.loadEventEnd - timing.navigationStart;
                
                if (loadTime < 2000) {
                    addResult('Performance', 'Page load time', 'pass', 
                        `${loadTime}ms (< 2 seconds)`);
                } else if (loadTime < 5000) {
                    addResult('Performance', 'Page load time', 'warn', 
                        `${loadTime}ms (2-5 seconds)`);
                } else {
                    addResult('Performance', 'Page load time', 'fail', 
                        `${loadTime}ms (> 5 seconds)`);
                }
            } else {
                addResult('Performance', 'Page load time', 'info', 
                    'Performance timing API not available');
            }
            
            addResult('Performance', 'Resource optimization', 'info', 
                'Check Network tab in DevTools for resource sizes and load times');
        }
    </script>
</body>
</html>
